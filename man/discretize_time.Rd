% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fct_.R
\name{discretize_time}
\alias{discretize_time}
\title{时间变量离散化 (Time Discretization)}
\usage{
discretize_time(datetime, grain = c("month", "week", "day"))
}
\arguments{
\item{datetime}{POSIXct 或 Date 类型的向量。需要离散化的时间数据。}

\item{grain}{字符型。时间颗粒度，可选值为 "month", "week", "day"。默认为 "month"。}
}
\value{
返回一个有序因子 (Ordered Factor)。因子的 Levels 按照时间先后顺序排列。
}
\description{
将时间对象（POSIXct 或 Date）按指定颗粒度转换为有序因子（Ordered Factor）。
}
\details{
针对 "week" 颗粒度，函数采用 **ISO 8601 标准周**定义：
\itemize{
  \item 使用 `%G` (ISO年份) 而非 `%Y` (日历年份) 来避免跨年周的排序错误。
  \item 格式生成为 "YYYY-Wxx"。
}
这种处理确保了如 2021-01-01 (属于2020年第53周) 会被正确标记为 "2020-W53"，
从而在绘图时保持正确的时间顺序。
}
\examples{
# 1. 基础用法
dates <- as.POSIXct(c("2023-01-15", "2023-02-20", "2023-01-10"))
discretize_time(dates, "month")

# 2. 跨年周测试 (修复了原函数的 Bug)
# 2021-01-01 其实是 2020年的第53周
tricky_date <- as.POSIXct("2021-01-01")

# 错误做法结果：2021-W53 (看起来像2021年底)
# 正确做法结果：2020-W53 (正确归类到时间轴的开头)
discretize_time(tricky_date, "week")
}
